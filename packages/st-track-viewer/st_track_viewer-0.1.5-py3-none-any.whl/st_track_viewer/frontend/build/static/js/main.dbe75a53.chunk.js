(this.webpackJsonpstreamlit_component_template=this.webpackJsonpstreamlit_component_template||[]).push([[0],{481:function(e,t,n){},482:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=482},735:function(e,t,n){},737:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(58),s=n.n(i),c=n(137),o=n(26),l=n(11),d=n(435),u=n(836),h=n(842),j=function(e){return e.UNKNOWN="Unknown",e.BICYCLE="Bicycle",e.PEDESTRIAN="Pedestrian",e.LIGHT_VEHICLE="Light vehicle",e.HEAVY_VEHICLE="Heavy vehicle",e}({}),b=Object.values(j);function f(e){return b.includes(e)}function m(e){switch(e){case j.UNKNOWN:return"green";case j.BICYCLE:return"purple";case j.PEDESTRIAN:return"red";case j.LIGHT_VEHICLE:return"cyan";case j.HEAVY_VEHICLE:return"pink"}}var g=200,O=n(41),x=n.n(O),p=n(197),v=n(50),y=n(13),k=n(7),w=n(8),M=n(4),C=n(5),S=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(M.a)(this,e),this._pos=void 0,this._pos=[t,n,a]}return Object(C.a)(e,[{key:"x",get:function(){return this._pos[0]},set:function(e){this._pos[0]=e}},{key:"y",get:function(){return this._pos[1]},set:function(e){this._pos[1]=e}},{key:"z",get:function(){return this._pos[2]},set:function(e){this._pos[2]=e}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z}},{key:"distanceTo",value:function(e){return Math.sqrt(Math.pow(e.x-this.x,2)+Math.pow(e.y-this.y,2)+Math.pow(e.z-this.z,2))}}],[{key:"cross",value:function(t,n){return new e(t.y*n.z-t.z*n.y,t.z*n.x-t.x*n.z,t.x*n.y-t.y*n.x)}}]),e}(),T=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return Object(M.a)(this,n),(e=t.call(this,a,r,i))._angles=void 0,e._angles=[s,c,o],e}return Object(C.a)(n,[{key:"yaw",get:function(){return this._angles[0]},set:function(e){this._angles[0]=e}},{key:"pitch",get:function(){return this._angles[1]},set:function(e){this._angles[1]=e}},{key:"roll",get:function(){return this._angles[2]},set:function(e){this._angles[2]=e}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z&&this.yaw===e.yaw&&this.pitch===e.pitch&&this.roll===e.roll}}]),n}(S);n(481),n(39);function I(){var e=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return e[0][0]=1,e[1][1]=1,e[2][2]=1,e[3][3]=1,e}function N(e,t){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],a=0;a<4;a++)for(var r=0;r<4;r++)n[a][r]=e[a][0]*t[0][r]+e[a][1]*t[1][r]+e[a][2]*t[2][r]+e[a][3]*t[3][r];return n}function L(e,t){var n=new S;return n.x=e[0][0]*t.x+e[0][1]*t.y+e[0][2]*t.z+e[0][3],n.y=e[1][0]*t.x+e[1][1]*t.y+e[1][2]*t.z+e[1][3],n.z=e[2][0]*t.x+e[2][1]*t.y+e[2][2]*t.z+e[2][3],n}function F(e,t){var n=Math.cos(t),a=Math.sin(t),r=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return r[0][0]=1,r[1][1]=n,r[1][2]=-a,r[2][1]=a,r[2][2]=n,r[3][3]=1,N(r,e)}function E(e,t){var n=Math.cos(t),a=Math.sin(t),r=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return r[0][0]=n,r[0][2]=a,r[1][1]=1,r[2][0]=-a,r[2][2]=n,r[3][3]=1,N(r,e)}function W(e,t){var n=Math.cos(t),a=Math.sin(t),r=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return r[0][0]=n,r[0][1]=-a,r[1][0]=a,r[1][1]=n,r[2][2]=1,r[3][3]=1,N(r,e)}function H(e,t,n,a){return e=F(e=E(e=W(e,t),n),a)}function R(e,t,n,a){var r=JSON.parse(JSON.stringify(e));return r[0][0]+=e[3][0]*t,r[0][1]+=e[3][1]*t,r[0][2]+=e[3][2]*t,r[0][3]+=e[3][3]*t,r[1][0]+=e[3][0]*n,r[1][1]+=e[3][1]*n,r[1][2]+=e[3][2]*n,r[1][3]+=e[3][3]*n,r[2][0]+=e[3][0]*a,r[2][1]+=e[3][1]*a,r[2][2]+=e[3][2]*a,r[2][3]+=e[3][3]*a,r}function D(e,t,n,a){var r=JSON.parse(JSON.stringify(e));return r[0][0]*=t,r[0][1]*=t,r[0][2]*=t,r[0][3]*=t,r[1][0]*=n,r[1][1]*=n,r[1][2]*=n,r[1][3]*=n,r[2][0]*=a,r[2][1]*=a,r[2][2]*=a,r[2][3]*=a,r}function B(e,t,n,a){return[(a=L(_(e,t,n),a)).x,a.y]}function _(e,t,n){var a=I();return a=R(a,-e.pos.x,-e.pos.y,-e.pos.z),a=R(a=D(a=H(a,-e.pos.yaw,-e.pos.pitch,-e.pos.roll),t/e.width,n/e.height,1),.5*t-.5,.5*n-.5,0)}var P=n(1),z=function(e){var t=e.WIDTH,n=e.HEIGHT,r=e.scale,i=e.tracks,s=e.ground,c=e.showId,o=e.filters;return Object(P.jsx)("svg",{width:t,height:n,style:{transform:"scale(".concat(r,")"),transformOrigin:"top left",overflow:"visible"},children:Object(a.useMemo)((function(){return i.map((function(e){var a=m(e.type),r=B(s,t,n,e.startPos),i=Object(l.a)(r,2),d=i[0],u=i[1],h=B(s,t,n,e.endPos),j=Object(l.a)(h,2),b=j[0],f=j[1];return Object(P.jsxs)("g",{children:[Object(P.jsx)("path",{d:e.pathString(s,t,n,o.onlyConfirmed,o.markMeasurements,o.markEstimated),stroke:a||"black",fill:"none"}),Object(P.jsx)("circle",{cx:d,cy:u,r:4,fill:"green",strokeWidth:"4"}),Object(P.jsx)("circle",{cx:b,cy:f,r:4,fill:"red",strokeWidth:"4"}),c&&Object(P.jsx)("text",{x:b,y:f,fill:"white",fontFamily:"sans-serif",fontSize:10,children:e.id})]},e.id)}))}),[i,s,c,n,t,o])})},K=n(409),V=n.n(K),A=n(832),Y=n(227),U=n(848),G=n(849),q=n(833),J=n(838),Q=function(e){var t=e.filters,n=e.onMarkMeasurements,a=e.onMarkEstimated,r=e.onMarkOnlyConfirmed,i=e.onMarkTrackId;return Object(P.jsx)(U.a,{sx:{margin:0,marginLeft:2},component:"fieldset",variant:"standard",children:Object(P.jsxs)(G.a,{row:!0,children:[Object(P.jsxs)(G.a,{children:[Object(P.jsx)(q.a,{control:Object(P.jsx)(J.a,{checked:t.markMeasurements,onChange:n}),label:Object(P.jsx)(Y.a,{fontSize:15,fontWeight:600,children:"Mark measurements"})}),Object(P.jsx)(q.a,{control:Object(P.jsx)(J.a,{checked:t.markEstimated,onChange:a}),label:Object(P.jsx)(Y.a,{fontSize:15,fontWeight:600,children:"Mark estimated"})})]}),Object(P.jsxs)(G.a,{children:[Object(P.jsx)(q.a,{control:Object(P.jsx)(J.a,{checked:t.onlyConfirmed,onChange:r}),label:Object(P.jsx)(Y.a,{fontSize:15,fontWeight:600,children:"Show only confirmed"})}),Object(P.jsx)(q.a,{control:Object(P.jsx)(J.a,{checked:t.trackId,onChange:i}),label:Object(P.jsx)(Y.a,{fontSize:15,fontWeight:600,children:"Show track id"})})]})]})})},X=n(850),Z=n(851),$=n(841),ee=n(830),te=n(855),ne=n(817),ae=function(){function e(t,n,a,r,i,s){Object(M.a)(this,e),this.id=void 0,this.startTime=void 0,this.endTime=void 0,this.timestamps=void 0,this.coordinates=void 0,this.speeds=void 0,this.estimated=void 0,this.type=void 0,this.startPos=void 0,this.endPos=void 0,this.id=t,this.timestamps=n,this.startTime=x()(n[0]),this.endTime=x()(n.at(-1)),this.coordinates=a[0].map((function(e,t){return new S(e,a[1][t],0)})),this.speeds=r,this.estimated=i.map((function(e){return 1===e})),this.type=function(e){switch(e){case 0:default:return j.UNKNOWN;case 1:return j.BICYCLE;case 4:return j.PEDESTRIAN;case 18:return j.LIGHT_VEHICLE;case 34:return j.HEAVY_VEHICLE}}(s),this.startPos=this.coordinates[0],this.endPos=this.coordinates[this.coordinates.length-1]}return Object(C.a)(e,[{key:"getEstimated",value:function(){var e=this;return this.coordinates.filter((function(t,n){return e.estimated[n]}))}},{key:"getConfirmed",value:function(){var e=this;return this.coordinates.filter((function(t,n){return!e.estimated[n]}))}},{key:"toGround",value:function(e,t,n){return this.coordinates.map((function(a){return B(e,t,n,a)}))}},{key:"length",value:function(){return this.startPos.distanceTo(this.endPos)}},{key:"speed",value:function(){return this.speeds.reduce((function(e,t){return e+t}),0)/this.speeds.length}},{key:"pathString",value:function(e,t,n,a,r,i){var s=this,c=B(e,t,n,this.startPos),o=Object(l.a)(c,2),d=o[0],u=o[1],h="M ".concat(d," ").concat(u," "),j=this.toGround(e,t,n);return j.forEach((function(e,t){var n=Object(l.a)(e,2),c=n[0],o=n[1],d=s.estimated[t];if((!a||!d)&&(h+="L ".concat(c," ").concat(o," "),0!==t&&(r&&!d||i&&d))){var u=d?3:6,b=Object(l.a)(j[t-1],2),f=b[0],m=b[1],g=Math.sqrt(Math.pow(f-c,2)+Math.pow(m-o,2)),O=0===g?1:g,x=[(o-m)/O,(f-c)/O],p=.707,v=x[0]*p-x[1]*p,y=x[0]*p+x[1]*p;h+="L ".concat(c+v*u," ").concat(o+y*u," L ").concat(c," ").concat(o," L ").concat(c-y*u," ").concat(o+v*u," L ").concat(c," ").concat(o," ")}})),h}}],[{key:"idCompare",value:function(e,t){return e.id-t.id}},{key:"lengthCompare",value:function(e,t){return e.length()-t.length()}},{key:"typeCompare",value:function(e,t){return b.indexOf(e.type)-b.indexOf(t.type)}},{key:"speedCompare",value:function(e,t){return e.speed()-t.speed()}}]),e}(),re=n(840),ie=n(806),se=n(807),ce=n(808),oe=function(e){var t=e.tracks,n=e.selectedTracks,a=e.onTrackSelect;return Object(P.jsxs)(P.Fragment,{children:[0!==t.length&&Object(P.jsxs)(re.a,{children:[Object(P.jsx)(ie.a,{sx:{visibility:"hidden"},children:Object(P.jsx)(J.a,{edge:"start",tabIndex:-1,disableRipple:!0})}),Object(P.jsx)(Y.a,{fontWeight:500,sx:{width:"25%"},children:"Id"}),Object(P.jsx)(Y.a,{fontWeight:500,sx:{width:"25%"},children:"Length"}),Object(P.jsx)(Y.a,{fontWeight:500,sx:{width:"25%"},children:"Speed"}),Object(P.jsx)(Y.a,{fontWeight:500,sx:{width:"25%"},children:"Type"})]}),t.map((function(e){return Object(P.jsxs)(se.a,{onClick:function(t){return a(t,e)},children:[Object(P.jsx)(ie.a,{children:Object(P.jsx)(J.a,{edge:"start",checked:n.has(e.id),tabIndex:-1,disableRipple:!0})}),Object(P.jsx)(ce.a,{style:{width:"25%"},primary:e.id}),Object(P.jsx)(ce.a,{style:{width:"25%"},primary:Math.round(1e4*(e.length()+Number.EPSILON))/1e4}),Object(P.jsx)(ce.a,{style:{width:"25%"},primary:Math.round(1e4*(e.speed()+Number.EPSILON))/1e4}),Object(P.jsx)(ce.a,{style:{width:"25%"},primary:e.type})]},e.id)}))]})},le=function(e){var t=e.width,n=e.tracks,r=e.switchLeftLabel,i=e.switchRightLabel,s=e.selectedTracks,c=e.onSwitch,o=e.onTrackSelect,d=["Id","Length","Speed","Type"],u=Object(a.useState)(d[0]),h=Object(l.a)(u,2),j=h[0],b=h[1];return Object(P.jsx)("div",{style:{marginTop:10,width:t},children:Object(P.jsxs)(X.a,{sx:{bgcolor:"background.paper",position:"relative",overflow:"auto",borderRadius:1,maxHeight:"100%"},dense:!0,subheader:Object(P.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginRight:20,marginLeft:20,minHeight:60},children:[Object(P.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(P.jsx)(Y.a,{fontWeight:600,children:r}),Object(P.jsx)(Z.a,{onChange:c}),Object(P.jsx)(Y.a,{fontWeight:600,children:i})]}),Object(P.jsxs)(U.a,{children:[Object(P.jsx)($.a,{id:"demo-simple-select-label",children:Object(P.jsx)(Y.a,{fontWeight:600,children:"Filter on"})}),Object(P.jsx)(ee.a,{sx:{height:40,width:100},labelId:"demo-simple-select-label",id:"demo-simple-select",value:j,label:Object(P.jsx)(Y.a,{fontWeight:600,children:"Filter on"}),onChange:function(e){var t;t=e.target.value,d.includes(t)&&b(e.target.value)},children:d.map((function(e,t){return Object(P.jsx)(te.a,{value:e,children:e},t)}))})]})]}),component:"nav","aria-label":"tracks list",children:[Object(P.jsx)(ne.a,{sx:{borderBottomWidth:3}}),Object(P.jsx)(oe,{tracks:function(e,t){return e.sort(function(e){switch(e){case"Id":default:return ae.idCompare;case"Length":return ae.lengthCompare;case"Type":return ae.typeCompare;case"Speed":return ae.speedCompare}}(t))}(n,j),selectedTracks:s,onTrackSelect:o})]})})},de=n(858),ue=n(818),he=n(819),je=n(144),be=n(83),fe=n(145),me=n(170),ge=n(143),Oe=n(74),xe=function(e){var t=e.backgroundColor,n=e.children;return Object(P.jsx)("div",{className:"custom-tooltip",style:{borderRadius:5,backgroundColor:t,borderColor:"#FFFFFF",paddingLeft:10,paddingRight:10,paddingTop:1,paddingBottom:1,border:"1px solid #FFF4F4"},children:n})},pe=function(e){var t=e.x,n=e.y,a=e.width,r=e.height,i=e.type;return Object(P.jsx)("rect",{x:t,y:n,width:a,height:r,fill:m(i||j.UNKNOWN)})},ve={top:0,right:5,left:-30,bottom:20},ye=function(e){var t=e.tracks,n=e.height,a=function(e){return console.log("Calculating LENGTHS!"),e.sort((function(e,t){return ae.typeCompare(e,t)})).reduce((function(e,t){var n=Math.round(t.length()),a=e.findIndex((function(e){return n===e.length&&e.type===t.type}));return-1!==a?e[a].nbr+=1:e.push({type:t.type,length:n,nbr:1}),e}),[])}(t),r=Object(Oe.a)().palette;return Object(P.jsx)(de.a,{height:n,children:Object(P.jsxs)(ue.a,{data:a,margin:ve,barSize:5,children:[Object(P.jsx)(he.a,{}),Object(P.jsx)(je.a,{dataKey:"length",type:"number",domain:["dataMin","dataMax"],fontFamily:"sans-serif",children:Object(P.jsx)(be.a,{fontFamily:"sans-serif",value:"Length (m)",offset:-8,position:"insideBottom"})}),Object(P.jsx)(fe.a,{type:"number",domain:[0,"dataMax"],fontFamily:"sans-serif"}),Object(P.jsx)(me.a,{content:function(e){var t=e.label,n=e.payload;return e.active&&n&&n.length?Object(P.jsxs)(xe,{backgroundColor:r.background.default,children:[Object(P.jsx)("p",{className:"lengt-label",style:{fontFamily:"sans-serif"},children:"Length: ".concat(t)}),Object(P.jsx)("p",{className:"nbr-label",style:{fontFamily:"sans-serif"},children:"Tracks: ".concat(n[0].value)})]}):null}}),Object(P.jsx)(ge.a,{dataKey:"nbr",shape:Object(P.jsx)(pe,{})})]})})},ke=n(276),we=n.n(ke),Me=(n(735),function(e){var t=e.open,n=e.collapsibleClassName,r=void 0===n?"collapsible-card":n,i=e.headerClassName,s=void 0===i?"collapsible-header":i,c=e.titleClassName,o=void 0===c?"title-text":c,d=e.contentClassName,u=void 0===d?"collapsible-content":d,h=e.contentContainerClassName,j=void 0===h?"collapsible-content-padding":h,b=e.children,f=e.header,m=Object(a.useState)(t),g=Object(l.a)(m,2),O=g[0],x=g[1],p=Object(a.useState)(t?void 0:0),v=Object(l.a)(p,2),y=v[0],k=v[1],w=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(y&&O&&w.current){var e=new ResizeObserver((function(e){k(e[0].contentRect.height)}));return e.observe(w.current),function(){e.disconnect()}}}),[y,O]),Object(a.useEffect)((function(){var e;k(O?null===(e=w.current)||void 0===e?void 0:e.getBoundingClientRect().height:0)}),[O]),Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)("div",{className:r,style:{borderRadius:5},children:[Object(P.jsxs)("div",{className:s,onClick:function(){x((function(e){return!e}))},style:{borderRadius:5},children:[Object(P.jsx)("div",{className:o,children:f}),O?Object(P.jsx)(we.a,{sx:{transform:"rotate(180deg)",transitionDuration:0}}):Object(P.jsx)(we.a,{})]}),Object(P.jsx)("div",{className:u,style:{height:y},children:Object(P.jsx)("div",{ref:w,children:Object(P.jsx)("div",{className:j,children:O?b:Object(P.jsx)(P.Fragment,{})})})})]})})}),Ce=n(859),Se=n(207),Te=n(429);function Ie(e){var t=e.length;if(t%2===0){var n=t/2;return(e[n-1]+e[n])/2}return e[Math.floor(t/2)]}var Ne=function(e){return e[e.WHISKER=0]="WHISKER",e[e.BOX=1]="BOX",e[e.MEDIAN=2]="MEDIAN",e}(Ne||{}),Le=function(e){var t=e.tracks,n=e.height,r=Object(a.useState)(Ne.MEDIAN),i=Object(l.a)(r,2),s=i[0],c=i[1],o=Object(Oe.a)().palette,d=function(e){return Object(a.useMemo)((function(){console.log("USING BOX");var t=b.map((function(e){return{type:e,speeds:[]}}));return e.forEach((function(e){var n=t.findIndex((function(t){return t.type===e.type}));t[n].speeds.push(e.speed())})),t.filter((function(e){return 0!==e.speeds.length})).map((function(e){if(1===e.speeds.length)return{type:e.type,min:0,bottomWhisker:0,bottomBox:0,topBox:0,topWhisker:0,max:0,average:e.speeds[0],median:e.speeds[0],upperQuartile:0,lowerQuartile:0,lowerEnd:0,upperEnd:0};var t=e.speeds.sort((function(e,t){return e-t})),n=t.length,a=t[0],r=t[n-1],i=t[Math.floor(n/2)],s=t.reduce((function(e,t){return e+t}),0)/n,c=t.slice(0,Math.floor(n/2)),o=t.slice(Math.ceil(n/2)),l=Ie(c),d=Ie(o),u=d-l,h=l-1.5*u,j=d+1.5*u;return{type:e.type,min:a,bottomWhisker:l-h<0?0:l-h,bottomBox:i-l,topBox:d-i,topWhisker:j-d,median:i,average:s,max:r,upperQuartile:d,lowerQuartile:l,lowerEnd:h<0?0:h,upperEnd:j}}))}),[e])}(t),u=function(){c(Ne.MEDIAN)},h=function(){c(Ne.BOX)},j=function(){c(Ne.WHISKER)};return Object(P.jsx)(de.a,{height:n,children:Object(P.jsxs)(Ce.a,{margin:ve,data:d,children:[Object(P.jsx)(he.a,{vertical:!1}),Object(P.jsx)(ge.a,{stackId:"a",dataKey:"lowerEnd",fill:"none"}),Object(P.jsx)(ge.a,{stackId:"a",dataKey:"bar",onMouseOver:j,shape:Object(P.jsx)(Fe,{})}),Object(P.jsx)(ge.a,{stackId:"a",dataKey:"bottomWhisker",onMouseOver:j,shape:Object(P.jsx)(Ee,{})}),Object(P.jsx)(ge.a,{stackId:"a",dataKey:"bottomBox",onMouseOver:h,children:d.map((function(e,t){return Object(P.jsx)(Se.a,{fill:m(d[t].type)},t)}))}),Object(P.jsx)(ge.a,{stackId:"a",onMouseOver:u,dataKey:"bar",shape:Object(P.jsx)(Fe,{})}),Object(P.jsx)(ge.a,{stackId:"a",dataKey:"topBox",onMouseOver:h,children:d.map((function(e,t){return Object(P.jsx)(Se.a,{fill:m(d[t].type)},t)}))}),Object(P.jsx)(ge.a,{stackId:"a",dataKey:"topWhisker",onMouseOver:j,shape:Object(P.jsx)(Ee,{})}),Object(P.jsx)(ge.a,{stackId:"a",dataKey:"bar",onMouseOver:j,shape:Object(P.jsx)(Fe,{})}),Object(P.jsx)(Te.a,{dataKey:"average",onMouseOver:u,fill:"white",stroke:"#FFF"}),Object(P.jsx)(je.a,{dataKey:"type",fontFamily:"sans-serif"}),Object(P.jsx)(fe.a,{fontFamily:"sans-serif"}),Object(P.jsx)(me.a,{content:function(e){var t=e.label,n=e.payload,a=e.active;if(a&&n&&n.length)switch(s){case Ne.BOX:return De({data:d,backgroundColor:o.background.default,label:t,payload:n,active:a});case Ne.MEDIAN:return He({data:d,backgroundColor:o.background.default,label:t,payload:n,active:a});case Ne.WHISKER:return Re({data:d,backgroundColor:o.background.default,label:t,payload:n,active:a})}return null}})]})})},Fe=function(e){var t=e.x,n=e.y,a=e.width,r=e.height;return null==t||null==n||null==a||null==r?null:Object(P.jsx)("line",{x1:t,y1:n,x2:t+a,y2:n,stroke:"#000",strokeWidth:5})},Ee=function(e){var t=e.x,n=e.y,a=e.width,r=e.height;return null==t||null==n||null==a||null==r?null:Object(P.jsx)("line",{x1:t+a/2,y1:n+r,x2:t+a/2,y2:n,stroke:"#000",strokeWidth:5,"stroke-dasharray":"5"})},We=function(e,t){return e[e.findIndex((function(e){return e.type===t}))].info.map((function(e){return Object(P.jsx)("p",{className:"lengt-label",style:{fontFamily:"sans-serif"},children:e},e)}))},He=function(e){var t=e.label,n=e.data,a=e.backgroundColor,r=n.map((function(e){return{type:e.type,info:["Median: ".concat(Math.round(100*e.median)/100),"Average: ".concat(Math.round(100*e.average)/100)]}}));return Object(P.jsx)(xe,{backgroundColor:a,children:We(r,t)})},Re=function(e){var t=e.label,n=e.data,a=e.backgroundColor,r=n.map((function(e){return{type:e.type,info:["Upper end: ".concat(Math.round(100*e.upperEnd)/100),"Lower end: ".concat(Math.round(100*e.lowerEnd)/100)]}}));return Object(P.jsx)(xe,{backgroundColor:a,children:We(r,t)})},De=function(e){var t=e.label,n=e.data,a=e.backgroundColor,r=n.map((function(e){return{type:e.type,info:["Upper quartile: ".concat(Math.round(100*e.upperQuartile)/100),"Lower quartile: ".concat(Math.round(100*e.lowerQuartile)/100)]}}));return Object(P.jsx)(xe,{backgroundColor:a,children:We(r,t)})},Be=function(e){var t=e.tracks,n=e.height,a=function(e){return console.log("Calculating SAMPLES!"),e.reduce((function(e,t){var n=t.coordinates.length,a=e.findIndex((function(e){return n===e.nbrOfSamples&&e.type===t.type}));return-1!==a?(e[a].nbr+=1,e[a].ids.push(t.id)):e.push({type:t.type,nbrOfSamples:n,nbr:1,ids:[t.id]}),e}),[])}(t),r=Object(Oe.a)().palette;return Object(P.jsx)(de.a,{height:n,children:Object(P.jsxs)(ue.a,{data:a,margin:ve,barSize:5,children:[Object(P.jsx)(he.a,{}),Object(P.jsx)(je.a,{dataKey:"nbrOfSamples",type:"number",domain:["dataMin","dataMax"],fontFamily:"sans-serif",children:Object(P.jsx)(be.a,{fontFamily:"sans-serif",value:"Number of samples",offset:-8,position:"insideBottom"})}),Object(P.jsx)(fe.a,{type:"number",domain:[0,"dataMax"],fontFamily:"sans-serif"}),Object(P.jsx)(me.a,{content:function(e){var t=e.payload,n=e.label;return e.active&&t&&t.length?Object(P.jsxs)(xe,{backgroundColor:r.background.default,children:[Object(P.jsx)("p",{className:"nbr-label",style:{fontFamily:"sans-serif"},children:"Id: ".concat(t[0].payload.ids)}),Object(P.jsx)("p",{className:"lengt-label",style:{fontFamily:"sans-serif"},children:"Nbr of samples: ".concat(n)})]}):null}}),Object(P.jsx)(ge.a,{dataKey:"nbr",shape:Object(P.jsx)(pe,{})})]})})},_e=function(e){var t=e.tracks,n=e.height;return Object(P.jsxs)(Me,{header:"Show diagrams",children:[Object(P.jsx)("h5",{style:{fontFamily:"sans-serif",color:"#FFFFFF",marginTop:0},children:"Length histogram"}),Object(P.jsx)(ye,{height:.3*n,tracks:t}),Object(P.jsx)("h5",{style:{fontFamily:"sans-serif",color:"#FFFFFF",marginTop:0},children:"Number of samples"}),Object(P.jsx)(Be,{height:.3*n,tracks:t}),Object(P.jsx)("h5",{style:{fontFamily:"sans-serif",color:"#FFFFFF",marginTop:0},children:"Speed box plot"}),Object(P.jsx)(Le,{height:.4*n,tracks:t})]})},Pe=n(6),ze=n(821),Ke=n(165),Ve=n(208),Ae=function(e){if(0===e.length)return[];var t=x()(e[0].timestamps[0]);return e.reduce((function(e,n){var a=n.speeds.map((function(e,a){var r;return r={},Object(Pe.a)(r,n.id,e),Object(Pe.a)(r,"time",x()(n.timestamps[a]).diff(t)),r}));return e=e.concat(a)}),[])},Ye=function(e){return e.reduce((function(e,t){var n=x()(t.startTime),a=t.speeds.map((function(e,a){var r;return 0===a&&console.log(),r={},Object(Pe.a)(r,t.id,e),Object(Pe.a)(r,"time",x()(t.timestamps[a]).diff(n)/1e3),r}));return e=e.concat(a)}),[])},Ue=function(e){return e.reduce((function(e,t){var n=t.speeds.map((function(e,n){var a;return a={},Object(Pe.a)(a,t.id,e),Object(Pe.a)(a,"time",t.startPos.distanceTo(t.coordinates[n])),a}));return e=e.concat(n)}),[])},Ge=function(e){var t=e.tracks,n=e.height,r=e.plotOn,i=function(e,t){return Object(a.useMemo)((function(){switch(t){case"Absolute time":return Ae(e);case"Relative time":return Ye(e);case"Distance from start":return Ue(e)}}),[e,t])}(t,r),s=Object(Oe.a)().palette;return Object(P.jsx)(de.a,{width:"100%",height:n,children:Object(P.jsxs)(ze.a,{data:i,children:[Object(P.jsx)(he.a,{}),Object(P.jsx)(je.a,{dataKey:"time",type:"number",domain:["dataMin","dataMax"],tickFormatter:function(e){return function(e,t,n){switch(t){case"Absolute time":return x.a.isDayjs(n)?0===e?n.format("HH:mm:ss"):n.add(e,"milliseconds").format("HH:mm:ss"):String(e);case"Relative time":return String(e)+" s";case"Distance from start":return String(e)+" m"}}(e,r,0!==t.length?t[0].startTime:void 0)},children:qe(r)}),Object(P.jsx)(fe.a,{children:Object(P.jsx)(be.a,{fontFamily:"sans-serif",value:"km/h",position:"insideLeft",angle:-90})}),Object(P.jsx)(me.a,{content:function(e){var n=e.active,a=e.payload,i=e.label;return n&&a&&a.length?Object(P.jsxs)(xe,{backgroundColor:s.background.default,children:[Object(P.jsx)("p",{className:"nbr-label",style:{fontFamily:"sans-serif"},children:"Id: ".concat(Object.keys(a[0].payload)[0])}),Object(P.jsx)("p",{className:"lengt-label",style:{fontFamily:"sans-serif"},children:"Speed: ".concat("number"===typeof a[0].value?Math.round(100*a[0].value)/100:a[0].value)}),Object(P.jsx)("p",{className:"lengt-label",style:{fontFamily:"sans-serif"},children:Je(i,r,0!==t.length?t[0].startTime:void 0)})]}):null}}),Object(P.jsx)(Ke.a,{}),t.map((function(e,t){return Object(P.jsx)(Ve.a,{type:"monotone",dataKey:"".concat(e.id),stroke:m(e.type),dot:!1},t)}))]})})},qe=function(e){switch(e){case"Absolute time":return Object(P.jsx)(be.a,{fontFamily:"sans-serif",value:"Time",position:"insideBottom"});case"Relative time":return Object(P.jsx)(be.a,{fontFamily:"sans-serif",value:"Seconds",position:"insideBottom"});case"Distance from start":return Object(P.jsx)(be.a,{fontFamily:"sans-serif",value:"Meters",position:"insideBottom"})}},Je=function(e,t,n){switch(t){case"Absolute time":return x.a.isDayjs(n)?0===e?"Time: "+n.format("HH:mm:ss"):"Time: "+n.add(e,"milliseconds").format("HH:mm:ss"):"Time: "+String(e);case"Relative time":return"Time: "+String(Math.round(100*e)/100)+" s";case"Distance from start":return"Distance: "+String(Math.round(100*e)/100)+" m"}},Qe=["Relative time","Absolute time","Distance from start"],Xe=function(e){var t=e.tracks,n=e.height,r=Object(a.useState)(Qe[0]),i=Object(l.a)(r,2),s=i[0],c=i[1];return Object(P.jsx)("div",{style:{height:n,width:"100%",marginTop:10,marginLeft:10},children:Object(P.jsxs)(Me,{header:"Speed",children:[Object(P.jsxs)(U.a,{sx:{marginBottom:2},children:[Object(P.jsx)($.a,{id:"demo-simple-select-label",children:Object(P.jsx)(Y.a,{fontWeight:600,children:"Plot on"})}),Object(P.jsx)(ee.a,{sx:{height:40,width:200},labelId:"demo-simple-select-label",id:"demo-simple-select",value:s,label:Object(P.jsx)(Y.a,{fontWeight:600,children:"Plot on"}),onChange:function(e){var t;t=e.target.value,Qe.includes(t)&&c(e.target.value)},children:Qe.map((function(e,t){return Object(P.jsx)(te.a,{value:e,children:e},t)}))})]}),Object(P.jsx)(Ge,{tracks:t,height:n,plotOn:s})]})})},Ze=function(e){var t=e.label,n=e.plotterWidth,r=e.image,i=e.imageWidth,s=e.imageHeight,c=e.tracks,d=e.ground,u=Object(a.useState)(Math.round(100*(n/i+Number.EPSILON))/100*.66),j=Object(l.a)(u,2),b=j[0],f=j[1],m=s*Math.round(100*(n/i+Number.EPSILON))/100,g=Object(a.useState)({markMeasurements:!1,markEstimated:!1,onlyConfirmed:!1,trackId:!1,showLines:!1,filterSelected:!1}),O=Object(l.a)(g,2),x=O[0],p=O[1],v=Object(a.useState)(new Set),k=Object(l.a)(v,2),w=k[0],M=k[1],C=Object(a.useState)(!0),S=Object(l.a)(C,2),T=S[0],I=S[1],N=function(){return c.filter((function(e){return x.filterSelected===w.has(e.id)}))};return Object(P.jsxs)("div",{style:{width:n},children:[Object(P.jsxs)("div",{children:[Object(P.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:10},children:[Object(P.jsxs)(h.a,{onClick:function(){return I((function(e){return!e}))},sx:{marginRight:1},variant:"text",children:["Version ",t]}),T&&Object(P.jsx)(A.a,{value:b,"aria-label":"Default",valueLabelDisplay:"auto",onChange:function(e,t){"number"===typeof t&&f(t)},min:0,max:4,step:.01,color:"primary",className:"slider",style:{margin:0,width:"66%",maxWidth:1060}})]}),T&&Object(P.jsx)(Q,{filters:x,onMarkMeasurements:function(e){p((function(t){return Object(o.a)(Object(o.a)({},t),{},{markMeasurements:e.target.checked})}))},onMarkEstimated:function(e){p((function(t){return Object(o.a)(Object(o.a)({},t),{},{markEstimated:e.target.checked})}))},onMarkOnlyConfirmed:function(e){p((function(t){return Object(o.a)(Object(o.a)({},t),{},{onlyConfirmed:e.target.checked})}))},onMarkTrackId:function(e){p((function(t){return Object(o.a)(Object(o.a)({},t),{},{trackId:e.target.checked})}))}})]}),Object(P.jsxs)("div",{style:{overflow:"hidden",height:s*b,minHeight:.5*m,maxHeight:.7*m,display:"flex",flexDirection:"row"},children:[Object(P.jsx)("div",{style:{width:"66%",overflow:"hidden"},children:Object(P.jsx)(V.a,{children:Object(P.jsx)("div",{className:"image-container",style:{width:i*b,height:s*b,backgroundImage:"url(".concat(r,")")},children:Object(P.jsx)(z,{tracks:N(),WIDTH:i,HEIGHT:s,scale:b,showId:x.trackId,ground:d,filters:x})})})}),Object(P.jsxs)("div",{style:{width:"33%",marginLeft:10},children:[Object(P.jsxs)(Y.a,{fontWeight:600,sx:{marginBottom:1},children:["Number of tracks: ",c.length]}),0!==c.length?Object(P.jsx)(_e,{height:.4*m-90,tracks:N()}):null]})]}),Object(P.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:.3*m+150},children:[Object(P.jsx)(le,{width:.5*n,tracks:Object(y.a)(c),switchLeftLabel:"Hide",switchRightLabel:"Show",selectedTracks:w,onSwitch:function(e){p((function(t){return Object(o.a)(Object(o.a)({},t),{},{filterSelected:e.target.checked})}))},onTrackSelect:function(e,t){w.has(t.id)?M((function(e){return e.delete(t.id),new Set(e)})):M((function(e){return e.add(t.id),new Set(e)}))}}),Object(P.jsx)(Xe,{tracks:N(),height:.3*m})]})]})},$e=function(e){var t=e.fromTime,n=e.toTime,a=e.showType,r=e.showVersions,i=e.filterLength,s=Object(c.useRenderData)(),o=s.args.images,l=s.args.shapes,d=s.args.grounds,u=s.args.names,h=d.map((function(e){return{pos:Object(v.a)(T,Object(y.a)(e[0])),height:e[1],width:e[2]}})),j=function(e,t,n){return e.isAfter(t)&&e.isBefore(n)},b=s.args.tracks.map((function(e){return e.map((function(e){return Object(v.a)(ae,Object(y.a)(e))})).filter((function(e){return function(e,t,n,a,r){return!(!j(e.startTime,t,n)&&!j(e.endTime,t,n))&&!!a.includes(e.type)&&(!r.filter||!(e.length()<r.minLength||e.length()>r.maxLength))}(e,t,n,a,i)}))})),f=r.length<=1?1:r.length%3===0?3:r.length%2===0?2:3;return Object(P.jsxs)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap"},children:[b.map((function(e,t){return-1===r.indexOf(u[t])?null:Object(P.jsx)("div",{style:{margin:5},children:Object(P.jsx)(Ze,{image:o[t],plotterWidth:(window.innerWidth-20*f)/f,imageHeight:l[t][0],imageWidth:l[t][1],tracks:e,label:u[t],ground:h[t]},o[t])})})),Object(P.jsx)("div",{style:{height:1e4}})]})},et=n(843),tt=n(430),nt=n(828),at=n(829),rt=n(822),it=function(e){var t=e.data,n=e.changeDate,a=e.changeTime,r=e.changeIntervalMin,i=e.changeIntervalSec;return Object(P.jsxs)(tt.a,{dateAdapter:rt.a,children:[Object(P.jsx)(nt.a,{label:Object(P.jsx)(Y.a,{fontWeight:600,children:"Date"}),format:"YYYY-MM-DD",value:t.date,onChange:n,sx:{backgroundColor:"background.default",borderRadius:1,marginRight:2,width:g}}),Object(P.jsx)(at.a,{label:Object(P.jsx)(Y.a,{fontWeight:600,children:"From time"}),value:t.fromTime,onChange:a,ampm:!1,sx:{backgroundColor:"background.default",borderRadius:1,marginRight:2,width:g}}),Object(P.jsx)(et.a,{label:Object(P.jsx)(Y.a,{fontWeight:600,children:"Interval in minutes"}),id:"outlined-start-adornment",sx:{width:150,backgroundColor:"background.default",borderRadius:1,marginRight:2},value:t.intervalMin,onChange:r}),Object(P.jsx)(et.a,{label:Object(P.jsx)(Y.a,{fontWeight:600,children:"Interval in seconds"}),id:"outlined-start-adornment",sx:{width:150,backgroundColor:"background.default",borderRadius:1,margin:0},value:t.intervalSec,onChange:i})]})},st=function(e){var t=e.data,n=e.checkFilterBox,a=e.changeMinLength,r=e.changeMaxLength;return Object(P.jsxs)("div",{children:[Object(P.jsx)(q.a,{control:Object(P.jsx)(J.a,{checked:t.filterLength.filter,onChange:n}),label:Object(P.jsx)(Y.a,{fontWeight:600,children:"Filter length"}),style:{margin:0,marginTop:10,fontWeight:500}}),t.filterLength.filter&&Object(P.jsxs)("div",{style:{marginTop:10},children:[Object(P.jsx)(et.a,{label:Object(P.jsx)(Y.a,{fontWeight:600,children:"Min length"}),id:"outlined-start-adornment",sx:{m:1,width:"25ch",backgroundColor:"background.default",borderRadius:1,margin:0,marginRight:2},value:t.filterLength.minLength,onChange:a}),Object(P.jsx)(et.a,{label:Object(P.jsx)(Y.a,{fontWeight:600,children:"Max length"}),id:"outlined-start-adornment",sx:{m:1,width:"25ch",backgroundColor:"background.default",borderRadius:1,margin:0,marginRight:2},value:t.filterLength.maxLength,onChange:r})]})]})},ct=n(844),ot=function(e){var t=e.title,n=e.value,a=e.labels,r=e.checked,i=e.handleChange,s={PaperProps:{style:{maxHeight:224,width:250}}};return Object(P.jsxs)(U.a,{sx:{m:1,width:g,margin:0,marginLeft:2},children:[Object(P.jsx)($.a,{id:"demo-multiple-name-label",children:Object(P.jsx)(Y.a,{fontWeight:600,children:t})}),Object(P.jsx)(ee.a,{labelId:"demo-multiple-name-label",id:"demo-multiple-name",multiple:!0,value:n,onChange:i,input:Object(P.jsx)(ct.a,{label:t}),renderValue:function(e){return e.join(", ")},MenuProps:s,sx:{backgroundColor:"background.default"},children:a.map((function(e,t){return Object(P.jsxs)(te.a,{value:e,children:[Object(P.jsx)(J.a,{checked:r(e)}),Object(P.jsx)(ce.a,{primary:e})]},t)}))})]})},lt=function(){var e=Object(c.useRenderData)(),t=e.args.names,n=e.args.data,r=x()(n.date),i={date:r,fromTime:r,intervalMin:n.min,intervalSec:n.sec,showType:n.types,showVersions:n.versions,filterLength:n.filter};console.log(i);var s=Object(a.useState)(i),j=Object(l.a)(s,2),m=j[0],g=j[1],O=e.theme,v=Object(d.a)({palette:{primary:{main:null===O||void 0===O?void 0:O.primaryColor},common:{black:null===O||void 0===O?void 0:O.base},text:{primary:null===O||void 0===O?void 0:O.textColor,secondary:null===O||void 0===O?void 0:O.textColor},action:{active:"#fff"},background:{default:null===O||void 0===O?void 0:O.secondaryBackgroundColor,paper:null===O||void 0===O?void 0:O.secondaryBackgroundColor}}});Object(a.useEffect)((function(){m.date.isValid()&&p.Streamlit.setComponentValue({date:m.date.format("YYYY-MM-DD HH:mm:ss"),min:m.intervalMin,sec:m.intervalSec,versions:m.showVersions,types:m.showType,filter:m.filterLength})}),[m.date]);var y=function(e){x.a.isDayjs(e)&&g((function(t){return t.fromTime.hour()!==e.hour()&&(t.date=e),t.fromTime=e,Object(o.a)({},t)}))};return Object(P.jsx)(u.a,{theme:v,children:Object(P.jsxs)("div",{style:{marginTop:30},children:[Object(P.jsx)(it,{data:m,changeDate:function(e){x.a.isDayjs(e)&&g((function(t){return t.date=e,Object(o.a)({},t)}))},changeTime:y,changeIntervalMin:function(e){var t=Number(e.target.value);isNaN(t)||g((function(e){return e.intervalMin=t,Object(o.a)({},e)}))},changeIntervalSec:function(e){var t=Number(e.target.value);isNaN(t)||g((function(e){return e.intervalSec=t,Object(o.a)({},e)}))}}),Object(P.jsx)(ot,{title:"Show versions",value:m.showVersions,labels:t,checked:function(e){return-1!==m.showVersions.indexOf(e)},handleChange:function(e){var n=e.target.value;g((function(e){return e.showVersions="string"===typeof n?n.split(""):n.sort((function(e,n){return t.indexOf(e)-t.indexOf(n)})),Object(o.a)({},e)}))}}),Object(P.jsx)(ot,{title:"Show types",value:m.showType,labels:b,checked:function(e){return f(e)&&-1!==m.showType.indexOf(e)},handleChange:function(e){var t=e.target.value;g((function(e){return e.showType="string"===typeof t?function(e){return f(e)?[e]:[]}(t):t,Object(o.a)({},e)}))}}),Object(P.jsx)(st,{data:m,checkFilterBox:function(e){g((function(t){return t.filterLength.filter=e.target.checked,Object(o.a)({},t)}))},changeMinLength:function(e){var t=Number(e.target.value);isNaN(t)||g((function(e){return e.filterLength.minLength=t,Object(o.a)({},e)}))},changeMaxLength:function(e){var t=Number(e.target.value);isNaN(t)||g((function(e){return e.filterLength.maxLength=t,Object(o.a)({},e)}))}}),Object(P.jsxs)("div",{style:{margin:0,marginTop:10},children:[Object(P.jsx)(h.a,{sx:{marginRight:2,backgroundColor:"background.default"},onClick:function(){y(m.fromTime.subtract(m.intervalMin,"minutes").subtract(m.intervalSec,"seconds"))},children:"<"}),Object(P.jsx)(h.a,{sx:{marginRight:2,backgroundColor:"background.default"},onClick:function(){y(m.fromTime.add(m.intervalMin,"minutes").add(m.intervalSec,"seconds"))},children:">"})]}),Object(P.jsx)($e,{fromTime:m.fromTime,toTime:m.fromTime.add(m.intervalMin,"minutes").add(m.intervalSec,"seconds"),showType:m.showType,showVersions:m.showVersions,filterLength:m.filterLength})]})})};console.warn=function(){},s.a.render(Object(P.jsx)(r.a.StrictMode,{children:Object(P.jsx)(c.StreamlitProvider,{children:Object(P.jsx)(lt,{})})}),document.getElementById("root"))}},[[737,1,2]]]);
//# sourceMappingURL=main.dbe75a53.chunk.js.map